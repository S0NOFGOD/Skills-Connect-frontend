<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>SkillConnect ‚Äî Login / Signup / Find Skilled People</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<!-- EMAILJS -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  (function(){
    emailjs.init("PpXJtmBS2cd6k1qfT");
  })();
</script>

<style>
* {margin:0;padding:0;box-sizing:border-box;font-family:'Montserrat',sans-serif;}
body{min-height:100vh;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);display:flex;align-items:center;justify-content:center;color:#fff;position:relative;}
.container{width:95%;max-width:420px;background:rgba(255,255,255,0.08);backdrop-filter:blur(20px);border-radius:20px;padding:30px;box-shadow:0 25px 60px rgba(0,0,0,0.4);animation:fadeIn 1s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
h1{text-align:center;font-weight:700;margin-bottom:10px;}
p{text-align:center;font-size:14px;opacity:0.85;margin-bottom:25px;}
input,select,button{width:100%;padding:14px;margin-bottom:15px;border-radius:12px;border:none;outline:none;font-size:14px;}
input,select{background:rgba(255,255,255,0.15);color:#fff;}
select option{color:#000;}
button{background:linear-gradient(135deg,#00c6ff,#0072ff);color:#fff;font-weight:600;cursor:pointer;transition:0.3s ease;}
button:hover{transform:scale(1.03);}
.tabs{display:flex;justify-content:space-around;margin-bottom:20px;}
.tab{padding:10px 20px;cursor:pointer;border-radius:12px;transition:0.3s ease;}
.tab.active{background:linear-gradient(135deg,#00c6ff,#0072ff);font-weight:700;}
.form-section{display:none;flex-direction:column;}
.form-section.active{display:flex;}
.error{color:#ff4b5c;font-size:12px;margin-bottom:10px;}
.locate-btn{background:rgba(255,255,255,0.12);border:1px solid rgba(255,255,255,0.25);font-size:13px;}
.result{display:none;margin-top:20px;background:rgba(0,0,0,0.4);padding:15px;border-radius:12px;text-align:center;}
.locked{opacity:0.5;}
.unlock{margin-top:15px;background:linear-gradient(135deg,#f7971e,#ffd200);color:#000;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;}
.modal-content{background:#111;padding:25px;border-radius:18px;width:90%;max-width:350px;text-align:center;}
.pay-btn{background:linear-gradient(135deg,#00ff99,#00cc66);color:#000;}
.close{margin-top:10px;background:transparent;border:1px solid #555;}
#skill-section{display:none;}
#logout-container{position:absolute;top:20px;left:20px;width:auto;}
#logout-btn{padding:10px 20px;background:linear-gradient(135deg,#ff4b5c,#ff1e00);border-radius:12px;font-weight:600;cursor:pointer;}
#forgot-email-container,#reset-password-container{display:none;flex-direction:column;}
</style>
</head>
<body>

<div id="logout-container" style="display:none;">
  <button id="logout-btn">Logout</button>
</div>

<div class="container" id="auth-container">
  <h1>Welcome to SkillConnect</h1>
  <p>Sign up or log in to find skilled people near you</p>

  <div class="tabs">
    <div class="tab active" id="login-tab">Login</div>
    <div class="tab" id="signup-tab">Signup</div>
  </div>

  <div class="form-section active" id="login">
    <div class="error" id="login-error"></div>
    <input type="email" id="login-email" placeholder="Email" required />
    <input type="password" id="login-password" placeholder="Password" required />
    <button id="login-btn">Login</button>

    <button style="background:linear-gradient(135deg,#ffa500,#ff6600);margin-bottom:10px;" id="forgot-btn">Forgot Password?</button>

    <div id="forgot-email-container">
      <input type="email" id="forgot-email" placeholder="Enter your email to reset password" />
      <button style="background:linear-gradient(135deg,#ff99cc,#ff3399);" id="send-reset-btn">Send Reset Link</button>
    </div>

    <div id="reset-password-container">
      <input type="text" id="reset-code" placeholder="Enter code received" />
      <input type="password" id="new-password" placeholder="New Password" />
      <input type="password" id="confirm-new-password" placeholder="Confirm Password" />
      <button style="background:linear-gradient(135deg,#33ccff,#0066ff);" id="reset-password-btn">Reset Password</button>
    </div>
  </div>

  <div class="form-section" id="signup">
    <div class="error" id="signup-error"></div>
    <input type="text" id="signup-name" placeholder="Full Name" required />
    <input type="email" id="signup-email" placeholder="Email" required />
    <input type="password" id="signup-password" placeholder="Password" required />
    <input type="password" id="signup-confirm-password" placeholder="Confirm Password" required />
    <button id="signup-btn">Signup</button>
  </div>
</div>

<!-- Skill Section & Modal remain unchanged -->
<div class="container" id="skill-section">
  <h1 id="welcome-text">SkillConnect</h1>
  <p>Find trusted skilled people near you</p>

  <select id="skill">
    <option value="">Select a skill</option>
    <option>Barber</option>
    <option>Phone Repairer</option>
    <option>Electrician</option>
    <option>Plumber</option>
    <option>Web Developer</option>
    <option>Cleaner</option>
  </select>

  <button class="locate-btn" id="locate-btn">üìç Use My Current Location</button>
  <input type="text" id="location" placeholder="Enter your area (e.g. Yaba)" />

  <button id="find-skill-btn">Find Skilled Person</button>

  <div class="result" id="result">
    <h3>Skilled Person Found</h3>
    <p class="locked" id="info">
      Name: ****<br>
      Phone: ****
    </p>
    <button class="unlock" id="unlock-btn">Unlock Contact (‚Ç¶500)</button>
  </div>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h2>Unlock Contact</h2>
    <p>Pay ‚Ç¶500 to access contact details.</p>
    <button class="pay-btn" id="pay-btn">Pay & Unlock</button>
    <button class="close" id="close-modal-btn">Cancel</button>
  </div>
</div>

<script>
let users = JSON.parse(localStorage.getItem('users')) || [];
let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
let generatedCode = null;

function switchTab(tab){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.form-section').forEach(f=>f.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.getElementById(tab+'-tab').classList.add('active');
  document.getElementById('forgot-email-container').style.display='none';
  document.getElementById('reset-password-container').style.display='none';
}

function signupUser() {
  const name = document.getElementById('signup-name').value.trim();
  const email = document.getElementById('signup-email').value.trim();
  const password = document.getElementById('signup-password').value.trim();
  const confirmPassword = document.getElementById('signup-confirm-password').value.trim();
  const error = document.getElementById('signup-error'); error.innerText='';
  if(!name||!email||!password||!confirmPassword){error.innerText="All fields required!";return;}
  if(!/\S+@\S+\.\S+/.test(email)){error.innerText="Invalid email!";return;}
  if(password.length<6){error.innerText="Password must be >=6 chars!";return;}
  if(password!==confirmPassword){error.innerText="Passwords do not match!";return;}
  if(users.find(u=>u.email===email)){error.innerText="Email already registered!";return;}
  users.push({name,email,password});
  localStorage.setItem('users',JSON.stringify(users));
  currentUser={name,email};
  localStorage.setItem('currentUser',JSON.stringify(currentUser));
  showSkillSection();
}

function loginUser(){
  const email=document.getElementById('login-email').value.trim();
  const password=document.getElementById('login-password').value.trim();
  const error=document.getElementById('login-error');error.innerText='';
  const user=users.find(u=>u.email===email && u.password===password);
  if(!user){error.innerText="Invalid email or password!";return;}
  currentUser=user;
  localStorage.setItem('currentUser',JSON.stringify(currentUser));
  showSkillSection();
}

function showSkillSection(){
  document.getElementById('auth-container').style.display='none';
  document.getElementById('skill-section').style.display='block';
  document.getElementById('logout-container').style.display='block';
  const firstName=currentUser.name.split(' ')[0];
  document.getElementById('welcome-text').innerText=`Welcome ${firstName}`;
}

function logoutUser(){
  document.getElementById('skill-section').style.display='none';
  document.getElementById('auth-container').style.display='block';
  document.getElementById('logout-container').style.display='none';
  currentUser=null;
  localStorage.removeItem('currentUser');
  document.getElementById('skill').value='';
  document.getElementById('location').value='';
  document.getElementById('result').style.display='none';
  document.getElementById('welcome-text').innerText='SkillConnect';
}

function showForgotEmail(){
  document.getElementById('forgot-email-container').style.display='flex';
  document.getElementById('reset-password-container').style.display='none';
}

function sendResetLink(){
  const email=document.getElementById('forgot-email').value.trim();
  if(!/\S+@\S+\.\S+/.test(email)){alert("Enter a valid email!"); return;}
  const user=users.find(u=>u.email===email);
  if(!user){alert("Email not registered!"); return;}
  generatedCode=Math.floor(100000+Math.random()*900000).toString();
  
  emailjs.send("service_5847wy6","template_d67hhwh",{
    to_email: email,
    reset_code: generatedCode
  })
  .then(()=> {
    alert("Reset code sent to your email!");
    document.getElementById('forgot-email-container').style.display='none';
    document.getElementById('reset-password-container').style.display='flex';
  })
  .catch(err=>{
    alert("Failed to send email. Please try again.");
    console.error(err);
  });
}

function completeReset(){
  const code=document.getElementById('reset-code').value.trim();
  const newPass=document.getElementById('new-password').value.trim();
  const confirmPass=document.getElementById('confirm-new-password').value.trim();
  const email=document.getElementById('forgot-email').value.trim();
  const user=users.find(u=>u.email===email);
  if(code!==generatedCode){alert("Invalid code!"); return;}
  if(newPass.length<6){alert("Password must be at least 6 characters!"); return;}
  if(newPass!==confirmPass){alert("Passwords do not match!"); return;}
  if(user){user.password=newPass; localStorage.setItem('users',JSON.stringify(users)); alert("Password reset successfully!");}
  document.getElementById('reset-password-container').style.display='none';
}

/* --- SKILL CONNECT & MODAL --- */
const skilledPeople=[
  {name:"John Barber",skill:"Barber",area:"yaba",phone:"0913 067 2159"},
  {name:"Samuel Fix",skill:"Phone Repairer",area:"ikeja",phone:"0802 445 9921"},
  {name:"Musa Sparks",skill:"Electrician",area:"surulere",phone:"0706 123 8876"},
  {name:"Tunde Web",skill:"Web Developer",area:"yaba",phone:"0811 555 9090"},
  {name:"Grace Clean",skill:"Cleaner",area:"lekki",phone:"0901 333 4401"}
];
let selectedPerson=null;
function findSkill(){
  const skill=document.getElementById('skill').value;
  const location=document.getElementById('location').value.toLowerCase().trim();
  if(!skill||!location){alert("Please select a skill and enter your location.");return;}
  selectedPerson=skilledPeople.find(p=>p.skill===skill && location.includes(p.area));
  if(!selectedPerson){alert("No skilled person found near your location.");return;}
  document.getElementById('info').innerHTML=`Name: ****<br>Phone: ****`;
  document.getElementById('info').classList.add('locked');
  document.getElementById('result').style.display='block';
}
function openModal(){document.getElementById('modal').style.display='flex';}
function closeModal(){document.getElementById('modal').style.display='none';}
function completePayment(){
  document.getElementById('info').innerHTML=`Name: ${selectedPerson.name}<br>Phone: ${selectedPerson.phone}`;
  document.getElementById('info').classList.remove('locked');
  closeModal();
}
function getUserLocation(){
  if(!navigator.geolocation){alert("Geolocation is not supported.");return;}
  navigator.geolocation.getCurrentPosition(success,error);
  function success(position){
    const lat=position.coords.latitude;
    const lon=position.coords.longitude;
    fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`)
      .then(res=>res.json())
      .then(data=>{
        const area=data.address.suburb||data.address.neighbourhood||data.address.city||data.address.town||data.address.state;
        document.getElementById('location').value=area||"Location detected";
      });
  }
  function error(){alert("Please allow location access.");}
}

/* --- Event Listeners --- */
document.getElementById('login-tab').addEventListener('click', ()=>switchTab('login'));
document.getElementById('signup-tab').addEventListener('click', ()=>switchTab('signup'));
document.getElementById('login-btn').addEventListener('click', loginUser);
document.getElementById('signup-btn').addEventListener('click', signupUser);
document.getElementById('forgot-btn').addEventListener('click', showForgotEmail);
document.getElementById('send-reset-btn').addEventListener('click', sendResetLink);
document.getElementById('reset-password-btn').addEventListener('click', completeReset);
document.getElementById('locate-btn').addEventListener('click', getUserLocation);
document.getElementById('find-skill-btn').addEventListener('click', findSkill);
document.getElementById('unlock-btn').addEventListener('click', openModal);
document.getElementById('pay-btn').addEventListener('click', completePayment);
document.getElementById('close-modal-btn').addEventListener('click', closeModal);

window.onload=function(){if(currentUser){showSkillSection();}}
</script>
</body>
  </html>
